var question_count=1,A="selected-answered",B="selected-review",C="selected",D="selected-reviewanswered",E="selected-unanswered",F="not-selected-answered",G="not-selected-review",H="not-selected",I="not-selected-reviewanswered",J="not-selected-unanswered",submit=0;$(function(e){function t(e){window.location.replace(e)}function s(){return e("#currentQuestion").val()}function a(t){return $array=e("#question_no_"+t).attr("class").split(" "),$newarray=$array[0].split("_"),$newarray[3]}function n(t){return e("[alt=catQuestion_"+t+"]").attr("rel")}function r(){var e=0;return e=b+h}function l(){var s=parseInt(Q/3600)%24,a=parseInt(Q/60)%60,n=Q%60;h+=1;var r="Time Left: "+(10>s?"0"+s:s)+":"+(10>a?"0"+a:a)+":"+(10>n?"0"+n:n);if(e("#timer").html(r),0==Q){var i=S,o=1,c=y-Q,u={user:w,category:i,attempted:o,finish:1,time:c};e.ajax({url:"processSubmission.php",type:"post",dataType:"json",data:{submit:u},cache:!1,success:function(s){e.blockUI({message:'<p>Paper is finished...</p><div class="loader col-center"></br></div>'}),t("../index.php")},error:function(e){console.log(JSON.stringify(e))}})}else O=setTimeout(function(){l()},1e3);Q-=1}function i(){var t=w,s=S,a=1,n={user:t,category:s,attempted:a};e.ajax({url:"processSubmission.php",type:"post",dataType:"json",data:{submit:n},cache:!1,success:function(e){},error:function(e){console.log(JSON.stringify(e))}})}function o(t,s){var a,n=e("#view_in option:selected").val();$id=t,$typeOfSelection=s,$split_id=$id.split("_");var l,i=$split_id[4],o=$split_id[6];if("clear"==s){e('input[name="option_'+$split_id[6]+'"]').prop("checked",!1);var u=e(".question_number_count_"+i);u.hasClass(A)?u.removeClass(A):u.hasClass(B)?u.removeClass(B):u.hasClass(D)?u.removeClass(D):u.hasClass(C)&&u.removeClass(C),u.addClass(E),a=r(),l={user:w,q_id:o,course:S,elapsed:a,lang:n}}else if("save"==s){var u=e(".question_number_count_"+i);i==g&&(i%=g);var d="question_number_count_"+(parseInt(i)+1);if(e('input[name="option_'+$split_id[6]+'"]').is(":checked"))var m=e('input[name="option_'+$split_id[6]+'"]:checked').next(),$=m.attr("id").split("opt_"),p=$[1];for(var f=-1,_=1;6>=_;_++)if(_==p){f=_;break}if(-1==f)return alert("No answer is selected."),!1;u.hasClass(A)?u.removeClass(A):u.hasClass(B)?u.removeClass(B):u.hasClass(D)?u.removeClass(D):u.hasClass(C)?u.removeClass(C):u.hasClass(E)&&u.removeClass(E),u.addClass(F),c(d,parseInt(i)+1),a=r(),l={user:w,q_id:o,course:S,option_selected:f,elapsed:a,lang:n}}else if("mark"==s){if(e('input[name="option_'+$split_id[6]+'"]').is(":checked"))var m=e('input[name="option_'+$split_id[6]+'"]:checked').next(),$=m.attr("id").split("opt_"),p=$[1];var f=-1,v=0,u=e(".question_number_count_"+i);i==g&&(i%=g);for(var d="question_number_count_"+(parseInt(i)+1),_=1;6>=_;_++)if(_==p){f=_,v=1;break}v?(u.hasClass(B)?u.removeClass(B):u.hasClass(A)?u.removeClass(A):u.hasClass(C)?u.removeClass(C):u.hasClass(E)&&u.removeClass(E),u.addClass(I)):(u.hasClass(A)?u.removeClass(A):u.hasClass(D)?u.removeClass(D):u.hasClass(C)?u.removeClass(C):u.hasClass(E)&&u.removeClass(E),u.addClass(G)),c(d,parseInt(i)+1),a=r(),l={user:w,q_id:o,course:S,option_selected:f,elapsed:a,lang:n}}return l}function c(e,t){$self=document.getElementsByClassName(e)[0];var s="-";$class_split=$self.className.split(" "),$required_class_name=$class_split[2],$class_array=$required_class_name.split("-"),$class_array.forEach(function(e){"not"!=e&&"selected"!=e&&(s+=e)}),"-"==s?($class="not-selected",$rclass="selected"):($class="not-selected"+s,$rclass="selected"+s),hasClass($self,$class)&&($self.classList.remove($class),$self.classList.add($rclass)),question_count=t}function u(e){$self=document.getElementsByClassName(e)[0];var t="-";$class_split=$self.className.split(" "),$required_class_name=$class_split[2],$class_array=$required_class_name.split("-"),$class_array.forEach(function(e){"not"!=e&&"selected"!=e&&(t+=e)}),"-"==t?($class="not-selected",$rclass="selected"):($class="not-selected"+t,$rclass="selected"+t),hasClass($self,$rclass)&&($self.classList.remove($rclass),$self.classList.add($class))}function d(e,t){return $element=document.getElementById("getQuestion_"+e+"_id_"+t),$element2=document.getElementById("select_qOption_"+t),$element.classList.add("hide"),$element2.classList.add("hide"),1}function m(e,t){return $element=document.getElementById("getQuestion_"+e+"_id_"+t),$element2=document.getElementById("select_qOption_"+t),$element.classList.remove("hide"),$element2.classList.remove("hide"),1}function $(){var t=e("#msgBox"),s=e("#msg");e("#modal-class").removeClass("modal-lg").addClass("modal-sm"),s.html("<p><font color=red>Do you want to Submit the Paper.<br>No further changes would be possible.<br>If Yes, press OK</font></p>"),t.modal("show"),submit=1}function p(t,a){var n,l=e("#view_in option:selected").val();return n=r(),userOb={user:w,id:s(),category:S,lang:l,elapsed:n}}function f(t){e("#question_selected_category").html(t)}var _,v,h=0,b=0,g=e("#totalQuestion").val(),y=e("#totalTime").val(),q=e("#lastTime").val(),x=Math.round((new Date).getTime()/1e3),N=x-q,Q=y-N;0>Q&&(Q=0);var O,w=e("#userID").val(),S=e("#paperCategory").val();e("#paperCourse").val();l(),i(),e("#msgOK").on("click",function(s){if(submit){var a=y-Q,n=S,r=1,l={time:a,category:n,user:w,attempted:r,finish:1};e.ajax({url:"processSubmission.php",type:"post",dataType:"json",data:{submit:l},cache:!1,success:function(s){e.blockUI({message:'<div class="text-center"><p>Paper is finished...<br>Saving your Result<br>Please do not refresh</p><div class="loader col-center"></div></div>'}),setTimeout(function(){t("../index.php")},3e3)},error:function(e){console.log(JSON.stringify(e))}})}}),e("#submit").on("click",function(e){e.preventDefault(),$()}),e('[name="save_next"]').on("click",function(t){t.preventDefault(),$self=e(this),$id=$self.attr("id"),dataObject=o($id,"save"),$qNumber=$id.split("_")[4],$qID=$id.split("_")[6],$qNumber==g?$next_question=1:$next_question=parseInt($qNumber)+1,$nextQElement=e('[name="question_entry_'+$next_question+'"]').attr("id"),$nextQID=$nextQElement.split("_")[3],$category=n($nextQID),f($category),dataObject&&e.ajax({url:"saveUserAnswer.php",type:"POST",dataType:"JSON",data:{data:dataObject},cache:!1,success:function(t){1==t.response?(h=0,d($qNumber,$qID),m($next_question,$nextQID),e("#currentQuestion").val($nextQID)):console.log("failed :"+JSON.stringify(t))},error:function(e){console.log("error :"+JSON.stringify(e))}})}),e('[name="mark_next"]').on("click",function(t){t.preventDefault(),$self=e(this),$id=$self.attr("id"),dataObject=o($id,"mark"),$qNumber=$id.split("_")[4],$qID=$id.split("_")[6],$qNumber==g?$next_question=1:$next_question=parseInt($qNumber)+1,$nextQElement=e('[name="question_entry_'+$next_question+'"]').attr("id"),$nextQID=$nextQElement.split("_")[3],$category=n($nextQID),f($category),e.ajax({url:"markUserAnswer.php",type:"POST",dataType:"JSON",data:{data:dataObject},cache:!1,success:function(t){1==t.response?(h=0,d($qNumber,$qID),m($next_question,$nextQID),e("#currentQuestion").val($nextQID)):console.log("failed :"+JSON.stringify(t))},error:function(e){console.log("error :"+JSON.stringify(e))}})}),e('[name="q_category"]').on("click",function(t){t.preventDefault();var r=(e("#view_in option:selected").val(),e(this).attr("id")),l=r.split("q_category_"),i=l[1];$currentQID=s(),$currentQNumber=a($currentQID),$nextElement=e('[rel="'+i+'"]').attr("id"),$splitNextElement=$nextElement.split("_"),$nextQID=$splitNextElement[3],$nextQNumber=$splitNextElement[1],$category=n($nextQID),f($category);var o="question_number_count_"+$nextQNumber,$="question_number_count_"+$currentQNumber;dataObject=p($nextQID,$nextQNumber),$currentQNumber!=$nextQNumber&&(u($),c(o,$nextQNumber)),e.ajax({url:"fetchQuestion.php",type:"POST",dataType:"JSON",data:{data:dataObject},cache:!1,success:function(t){1==t.response?(h=0,d($currentQNumber,$currentQID),m($nextQNumber,$nextQID),e("#currentQuestion").val($nextQID)):console.log("failed :"+JSON.stringify(t))},error:function(e){console.log("error :"+JSON.stringify(e))}})}),e('[name="question_count"]').on("click",function(t){t.preventDefault(),$that=e(this),_=$that.attr("id"),v=_.split("question_no_"),$qID=v[1],$qNumber=a($qID),$currentQID=s(),$currentQNumber=a($currentQID),$category=n($qID),f($category);var r="question_number_count_"+$qNumber,l="question_number_count_"+$currentQNumber;dataObject=p($qID,$qNumber),$currentQNumber!=$qNumber&&(u(l),c(r,$qNumber)),e.ajax({url:"fetchQuestion.php",type:"post",dataType:"json",data:{data:dataObject},cache:!1,success:function(t){1==t.response?(h=0,d($currentQNumber,$currentQID),m($qNumber,$qID),e("#currentQuestion").val($qID)):console.log("failed :"+JSON.stringify(t))},error:function(e){console.log("error :"+JSON.stringify(e))}})}),e(".modal").on("hidden.bs.modal",function(){var t=(e("#msgBox"),e("#msg")),s=e("#msgTitle");s.html("Attention!!!"),t.html(""),submit=0}),e('[name="clear"]').on("click",function(t){t.preventDefault(),$self=e(this),$id=$self.attr("id"),dataObject=o($id,"clear"),$qNumber=$id.split("_")[4],$qID=$id.split("_")[6],e.ajax({url:"clearUserAnswer.php",type:"POST",dataType:"JSON",data:{data:dataObject},cache:!1,success:function(e){1==e.response?h=0:console.log("failed :"+JSON.stringify(e))},error:function(e){console.log("error :"+JSON.stringify(e))}})}),e("#instructions").on("click",function(t){t.preventDefault();var s=e("#msgBox"),a=e("#msg"),n=e("#msgTitle");e("#modal-class").removeClass("modal-sm").addClass("modal-lg"),n.html("Instructions For The Exam"),a.html("<iframe src=frameinstructions.html width=100% height=60%></iframe>"),s.modal("show")})});